# CmakeCpp

## 概要
cmakeを用いたC++のプロジェクト。

## 所有権と参照
あるクラスAが他のクラスBの所有権を持った上で、Bを参照する処理やクラスがインスタンスが存在するとする。
非同期処理が無ければ参照でもポインタでも大体問題無いが、非同期処理が絡むと「解放されているかもしれないインスタンス」への参照を扱う場面が出てくる。
素直にやるとAはBのshared_ptrを持ち、Bを参照する側はweak_ptrを持つ形になる。
しかしshared_ptrにすると安易にコピー出来てA以外が所有権を持つ状態が発生しやすい。
自身への参照を渡したい時はshared_from_thisが必要とかも面倒。
AがBのunique_ptrを明示的に持ったまま、他の処理はその参照を持つことで上手い事いかないかと試した。

## 結論
shared_ptrとweak_ptrを使うのが一番いい。というか確実な方法はこれしかない。
ポインタやunique_ptrの参照を持つことで解放されたかどうか確認できそうな気がしたが、仮にヌルチェックができてもその後の操作中に解放される可能性がある。
また、ポインタの参照を持つと、そのポインタ自体が解放される可能性もある。
これらの問題を避けるにはshared_ptrとweak_ptrを使うのが最も安全で確実な方法である。

## ClaudeCodeからの補足
